cmake_minimum_required(VERSION 3.10)
project(btc_tracker)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_PREFIX_PATH "C:/dev/vcpkg/installed/x64-windows")

find_package(OpenSSL REQUIRED)
find_package(fmt CONFIG REQUIRED)
find_package(httplib CONFIG REQUIRED)
find_package(nlohmann_json CONFIG REQUIRED)

add_executable(btc_tracker main.cpp)

target_link_libraries(btc_tracker PRIVATE
    fmt::fmt
    httplib::httplib 
    nlohmann_json::nlohmann_json
    OpenSSL::SSL 
    OpenSSL::Crypto 
    ws2_32
    crypt32
)

#copying .dll
if(MSVC)
    add_custom_command(TARGET btc_tracker POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy_if_different
        $<TARGET_RUNTIME_DLLS:btc_tracker>
        $<TARGET_FILE_DIR:btc_tracker>
        COMMAND_EXPAND_LISTS
    )
endif()